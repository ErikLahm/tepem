import numpy as np
import numpy.typing as npt


def phi_0(x: float, y: float) -> float:
    return (
        6.25
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )


def phi_1(x: float, y: float) -> float:
    return (
        1.0
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (
            -260.416666666667 * y**4
            + 677.083333333333 * y**3
            - 614.583333333333 * y**2
            + 222.916666666667 * y
            - 25.0
        )
    )


def phi_2(x: float, y: float) -> float:
    return (
        4.16666666666667
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )


def phi_3(x: float, y: float) -> float:
    return (
        1.0
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (
            -130.208333333333 * y**4
            + 286.458333333333 * y**3
            - 213.541666666667 * y**2
            + 63.5416666666667 * y
            - 6.25
        )
    )


def phi_4(x: float, y: float) -> float:
    return (
        25.0
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )


def phi_5(x: float, y: float) -> float:
    return (
        4.0
        * x
        * y
        * (1 - x)
        * (
            -260.416666666667 * y**4
            + 677.083333333333 * y**3
            - 614.583333333333 * y**2
            + 222.916666666667 * y
            - 25.0
        )
    )


def phi_6(x: float, y: float) -> float:
    return (
        16.6666666666667
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )


def phi_7(x: float, y: float) -> float:
    return (
        4.0
        * x
        * y
        * (1 - x)
        * (
            -130.208333333333 * y**4
            + 286.458333333333 * y**3
            - 213.541666666667 * y**2
            + 63.5416666666667 * y
            - 6.25
        )
    )


def phi_8(x: float, y: float) -> float:
    return (
        6.25
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )


def phi_9(x: float, y: float) -> float:
    return (
        x
        * y
        * (2.0 * x - 1.0)
        * (
            -260.416666666667 * y**4
            + 677.083333333333 * y**3
            - 614.583333333333 * y**2
            + 222.916666666667 * y
            - 25.0
        )
    )


def phi_10(x: float, y: float) -> float:
    return (
        4.16666666666667
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )


def phi_11(x: float, y: float) -> float:
    return (
        x
        * y
        * (2.0 * x - 1.0)
        * (
            -130.208333333333 * y**4
            + 286.458333333333 * y**3
            - 213.541666666667 * y**2
            + 63.5416666666667 * y
            - 6.25
        )
    )


def grad_phi_0(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 12.5 * y * (x - 1) * (y - 1) * (
        1.66666666666667 * y - 1.33333333333333
    ) * (2.5 * y - 1.5) * (5.0 * y - 2.0) + 6.25 * y * (2.0 * x - 1.0) * (y - 1) * (
        1.66666666666667 * y - 1.33333333333333
    ) * (
        2.5 * y - 1.5
    ) * (
        5.0 * y - 2.0
    )
    phi_dy = (
        31.25
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        + 15.625
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (5.0 * y - 2.0)
        + 10.4166666666667
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 6.25
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 6.25
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_1(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 2.0 * y * (x - 1) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    ) + 1.0 * y * (2.0 * x - 1.0) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    phi_dy = 1.0 * y * (x - 1) * (2.0 * x - 1.0) * (
        -1041.66666666667 * y**3
        + 2031.25 * y**2
        - 1229.16666666667 * y
        + 222.916666666667
    ) + 1.0 * (x - 1) * (2.0 * x - 1.0) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_2(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 8.33333333333333 * y * (x - 1) * (y - 1) * (2.5 * y - 0.5) * (
        5.0 * y - 2.0
    ) * (5.0 * y - 4.0) + 4.16666666666667 * y * (2.0 * x - 1.0) * (y - 1) * (
        2.5 * y - 0.5
    ) * (
        5.0 * y - 2.0
    ) * (
        5.0 * y - 4.0
    )
    phi_dy = (
        20.8333333333333
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        + 20.8333333333333
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 4.0)
        + 10.4166666666667
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 4.16666666666667
        * y
        * (x - 1)
        * (2.0 * x - 1.0)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 4.16666666666667
        * (x - 1)
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_3(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 2.0 * y * (x - 1) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    ) + 1.0 * y * (2.0 * x - 1.0) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    phi_dy = 1.0 * y * (x - 1) * (2.0 * x - 1.0) * (
        -520.833333333333 * y**3
        + 859.375 * y**2
        - 427.083333333333 * y
        + 63.5416666666667
    ) + 1.0 * (x - 1) * (2.0 * x - 1.0) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_4(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = -25.0 * x * y * (y - 1) * (1.66666666666667 * y - 1.33333333333333) * (
        2.5 * y - 1.5
    ) * (5.0 * y - 2.0) + 25.0 * y * (1 - x) * (y - 1) * (
        1.66666666666667 * y - 1.33333333333333
    ) * (
        2.5 * y - 1.5
    ) * (
        5.0 * y - 2.0
    )
    phi_dy = (
        125.0
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        + 62.5
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (5.0 * y - 2.0)
        + 41.6666666666667
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 25.0
        * x
        * y
        * (1 - x)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 25.0
        * x
        * (1 - x)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_5(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = -4.0 * x * y * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    ) + 4.0 * y * (1 - x) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    phi_dy = 4.0 * x * y * (1 - x) * (
        -1041.66666666667 * y**3
        + 2031.25 * y**2
        - 1229.16666666667 * y
        + 222.916666666667
    ) + 4.0 * x * (1 - x) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_6(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = -16.6666666666667 * x * y * (y - 1) * (2.5 * y - 0.5) * (5.0 * y - 2.0) * (
        5.0 * y - 4.0
    ) + 16.6666666666667 * y * (1 - x) * (y - 1) * (2.5 * y - 0.5) * (5.0 * y - 2.0) * (
        5.0 * y - 4.0
    )
    phi_dy = (
        83.3333333333334 * x * y * (1 - x) * (y - 1) * (2.5 * y - 0.5) * (5.0 * y - 2.0)
        + 83.3333333333333
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 4.0)
        + 41.6666666666667
        * x
        * y
        * (1 - x)
        * (y - 1)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 16.6666666666667
        * x
        * y
        * (1 - x)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 16.6666666666667
        * x
        * (1 - x)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_7(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = -4.0 * x * y * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    ) + 4.0 * y * (1 - x) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    phi_dy = 4.0 * x * y * (1 - x) * (
        -520.833333333333 * y**3
        + 859.375 * y**2
        - 427.083333333333 * y
        + 63.5416666666667
    ) + 4.0 * x * (1 - x) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_8(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 12.5 * x * y * (y - 1) * (1.66666666666667 * y - 1.33333333333333) * (
        2.5 * y - 1.5
    ) * (5.0 * y - 2.0) + 6.25 * y * (2.0 * x - 1.0) * (y - 1) * (
        1.66666666666667 * y - 1.33333333333333
    ) * (
        2.5 * y - 1.5
    ) * (
        5.0 * y - 2.0
    )
    phi_dy = (
        31.25
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        + 15.625
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (5.0 * y - 2.0)
        + 10.4166666666667
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 6.25
        * x
        * y
        * (2.0 * x - 1.0)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
        + 6.25
        * x
        * (2.0 * x - 1.0)
        * (y - 1)
        * (1.66666666666667 * y - 1.33333333333333)
        * (2.5 * y - 1.5)
        * (5.0 * y - 2.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_9(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 2.0 * x * y * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    ) + y * (2.0 * x - 1.0) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    phi_dy = x * y * (2.0 * x - 1.0) * (
        -1041.66666666667 * y**3
        + 2031.25 * y**2
        - 1229.16666666667 * y
        + 222.916666666667
    ) + x * (2.0 * x - 1.0) * (
        -260.416666666667 * y**4
        + 677.083333333333 * y**3
        - 614.583333333333 * y**2
        + 222.916666666667 * y
        - 25.0
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_10(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 8.33333333333333 * x * y * (y - 1) * (2.5 * y - 0.5) * (5.0 * y - 2.0) * (
        5.0 * y - 4.0
    ) + 4.16666666666667 * y * (2.0 * x - 1.0) * (y - 1) * (2.5 * y - 0.5) * (
        5.0 * y - 2.0
    ) * (
        5.0 * y - 4.0
    )
    phi_dy = (
        20.8333333333333
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        + 20.8333333333333
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 4.0)
        + 10.4166666666667
        * x
        * y
        * (2.0 * x - 1.0)
        * (y - 1)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 4.16666666666667
        * x
        * y
        * (2.0 * x - 1.0)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
        + 4.16666666666667
        * x
        * (2.0 * x - 1.0)
        * (y - 1)
        * (2.5 * y - 0.5)
        * (5.0 * y - 2.0)
        * (5.0 * y - 4.0)
    )
    return np.array([phi_dx, phi_dy])


def grad_phi_11(x: float, y: float) -> npt.NDArray[np.float64]:
    phi_dx = 2.0 * x * y * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    ) + y * (2.0 * x - 1.0) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    phi_dy = x * y * (2.0 * x - 1.0) * (
        -520.833333333333 * y**3
        + 859.375 * y**2
        - 427.083333333333 * y
        + 63.5416666666667
    ) + x * (2.0 * x - 1.0) * (
        -130.208333333333 * y**4
        + 286.458333333333 * y**3
        - 213.541666666667 * y**2
        + 63.5416666666667 * y
        - 6.25
    )
    return np.array([phi_dx, phi_dy])


Q25_SF_LIST = [
    phi_0,
    phi_1,
    phi_2,
    phi_3,
    phi_4,
    phi_5,
    phi_6,
    phi_7,
    phi_8,
    phi_9,
    phi_10,
    phi_11,
]

Q25_GRAD_SF_LIST = [
    grad_phi_0,
    grad_phi_1,
    grad_phi_2,
    grad_phi_3,
    grad_phi_4,
    grad_phi_5,
    grad_phi_6,
    grad_phi_7,
    grad_phi_8,
    grad_phi_9,
    grad_phi_10,
    grad_phi_11,
]
